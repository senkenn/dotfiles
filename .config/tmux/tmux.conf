# ====================
# 基本設定
# ====================

# 256色対応
set -g default-terminal "tmux-256color"
set -ag terminal-overrides ",alacritty:RGB"

# マウス操作を有効化
set -g mouse on

# ウィンドウ番号を1から開始
set -g base-index 1
setw -g pane-base-index 1

# ウィンドウを閉じた時に番号を詰める
set -g renumber-windows on

# エスケープキーの遅延を無くす (vim用)
set -sg escape-time 0

# ヒストリ上限
set -g history-limit 50000

# ====================
# キーバインド
# ====================

# 設定リロード
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# ペイン分割 (現在のディレクトリを維持)
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# ペイン移動 (vim風)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# ペインリサイズ (vim風)
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# 新しいウィンドウ (現在のディレクトリを維持)
bind c new-window -c "#{pane_current_path}"

# ====================
# コピーモード (vi風)
# ====================

set -s set-clipboard external
set-option -gw mode-keys vi
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-selection-and-cancel

# ====================
# ステータスバー
# ====================

set -g status-position top
set -g status-style "bg=default,fg=white"

set -g status-left "#[fg=blue,bold][#S] "
set -g status-left-length 20

set -g status-right "#[fg=yellow]%Y-%m-%d %H:%M"
set -g status-right-length 50

setw -g window-status-format " #I:#W "
setw -g window-status-current-format "#[fg=black,bg=cyan,bold] #I:#W "

# ====================
# プラグイン (TPM)
# ====================

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-resurrect'    # セッション保存・復元
set -g @plugin 'tmux-plugins/tmux-continuum'    # 自動保存

# セッション自動保存
set -g @continuum-restore 'on'

# TPM初期化 (この行は最後に置く)
run '~/.tmux/plugins/tpm/tpm'
